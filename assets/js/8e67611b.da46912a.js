"use strict";(self.webpackChunknotas_personales=self.webpackChunknotas_personales||[]).push([[3873],{690:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>t,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var n=i(4848),o=i(8453);const s={title:"Logging",sidebar_position:10},a=void 0,l={id:"Lenguajes de programaci\xf3n/Java/Spring/Spring Security/Arquitectura/Logging",title:"Logging",description:"\xbfQu\xe9 es el Logging en Spring Security?",source:"@site/docs/Lenguajes de programaci\xf3n/Java/Spring/Spring Security/Arquitectura/Logging.md",sourceDirName:"Lenguajes de programaci\xf3n/Java/Spring/Spring Security/Arquitectura",slug:"/Lenguajes de programaci\xf3n/Java/Spring/Spring Security/Arquitectura/Logging",permalink:"/notas-de-aprendizaje/docs/Lenguajes de programaci\xf3n/Java/Spring/Spring Security/Arquitectura/Logging",draft:!1,unlisted:!1,editUrl:"https://github.com/SanRM/notas-de-aprendizaje/edit/main/docs/Lenguajes de programaci\xf3n/Java/Spring/Spring Security/Arquitectura/Logging.md",tags:[],version:"current",lastUpdatedBy:"SanRM",lastUpdatedAt:1729228641e3,sidebarPosition:10,frontMatter:{title:"Logging",sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Guardar y reutilizar solicitudes",permalink:"/notas-de-aprendizaje/docs/Lenguajes de programaci\xf3n/Java/Spring/Spring Security/Arquitectura/Guardar solicitudes"},next:{title:"Autenticaci\xf3n",permalink:"/notas-de-aprendizaje/docs/Lenguajes de programaci\xf3n/Java/Spring/Spring Security/Autenticaci\xf3n/"}},t={},c=[{value:"\xbfQu\xe9 es el Logging en Spring Security?",id:"qu\xe9-es-el-logging-en-spring-security",level:3},{value:"\xbfPor qu\xe9 es importante el Logging en Spring Security?",id:"por-qu\xe9-es-importante-el-logging-en-spring-security",level:3},{value:"Ejemplo con CSRF (Cross-Site Request Forgery)",id:"ejemplo-con-csrf-cross-site-request-forgery",level:4},{value:"An\xe1lisis del Ejemplo de Log",id:"an\xe1lisis-del-ejemplo-de-log",level:4},{value:"C\xf3mo Configurar Logging en Spring Security",id:"c\xf3mo-configurar-logging-en-spring-security",level:3},{value:"Opci\xf3n 1: Usar el archivo <code>application.properties</code> en Spring Boot",id:"opci\xf3n-1-usar-el-archivo-applicationproperties-en-spring-boot",level:4},{value:"Opci\xf3n 2: Configuraci\xf3n usando <code>logback.xml</code>",id:"opci\xf3n-2-configuraci\xf3n-usando-logbackxml",level:4}];function d(e){const r={code:"code",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components},{Card:i}=r;return i||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Card",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.h3,{id:"qu\xe9-es-el-logging-en-spring-security",children:"\xbfQu\xe9 es el Logging en Spring Security?"}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Logging"})," en Spring Security se refiere al registro de eventos relacionados con la seguridad de la aplicaci\xf3n, como la autorizaci\xf3n, autenticaci\xf3n, rechazos de solicitudes, entre otros. Spring Security proporciona un registro detallado a trav\xe9s de los niveles ",(0,n.jsx)(r.strong,{children:"DEBUG"})," y ",(0,n.jsx)(r.strong,{children:"TRACE"}),", que son niveles de detalle en los mensajes de log (registros). Estos niveles te ayudan a entender mejor por qu\xe9 una solicitud fue rechazada o c\xf3mo se manejaron ciertos aspectos de seguridad."]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"DEBUG"}),": Nivel de registro que ofrece informaci\xf3n \xfatil sobre el funcionamiento interno, pero no todos los detalles."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"TRACE"}),": Nivel de registro que proporciona a\xfan m\xe1s detalles, \xfatil cuando necesitas un an\xe1lisis profundo de lo que est\xe1 ocurriendo."]}),"\n"]}),"\n",(0,n.jsxs)(i,{children:[(0,n.jsx)(r.h3,{id:"por-qu\xe9-es-importante-el-logging-en-spring-security",children:"\xbfPor qu\xe9 es importante el Logging en Spring Security?"}),(0,n.jsxs)(r.p,{children:["Cuando una solicitud es rechazada debido a medidas de seguridad, como un error 401 (No autorizado) o un 403 (Prohibido), Spring Security ",(0,n.jsx)(r.strong,{children:"no proporciona detalles espec\xedficos"})," en la respuesta al cliente por razones de seguridad. Esto significa que si un cliente recibe uno de estos c\xf3digos de error, no sabr\xe1 directamente por qu\xe9 fue rechazado. Aqu\xed es donde el logging resulta crucial. Los registros internos pueden darte una explicaci\xf3n detallada del motivo por el cual se rechaz\xf3 la solicitud."]})]}),"\n",(0,n.jsxs)(i,{children:[(0,n.jsx)(r.h4,{id:"ejemplo-con-csrf-cross-site-request-forgery",children:"Ejemplo con CSRF (Cross-Site Request Forgery)"}),(0,n.jsxs)(r.p,{children:["Imagina que un usuario intenta hacer una solicitud ",(0,n.jsx)(r.strong,{children:"POST"})," a un recurso que est\xe1 protegido con una medida de seguridad llamada ",(0,n.jsx)(r.strong,{children:"CSRF"})," (Cross-Site Request Forgery). Este tipo de protecci\xf3n requiere que las solicitudes incluyan un token CSRF v\xe1lido. Si la solicitud no incluye este token, ser\xe1 rechazada con un error 403."]}),(0,n.jsx)(r.p,{children:"Ahora, sin logs habilitados, el cliente ver\xe1 solo el error 403, sin m\xe1s informaci\xf3n. Sin embargo, si tienes activado el registro para Spring Security, ver\xe1s algo como esto:"}),(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"2023-06-14T09:44:25.797-03:00 DEBUG 76975 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing POST /hello\r\n2023-06-14T09:44:25.797-03:00 TRACE 76975 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/15)\r\n2023-06-14T09:44:25.802-03:00 TRACE 76975 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (5/15)\r\n2023-06-14T09:44:25.814-03:00 DEBUG 76975 --- [nio-8080-exec-1] o.s.security.web.csrf.CsrfFilter         : Invalid CSRF token found for http://localhost:8080/hello\r\n2023-06-14T09:44:25.814-03:00 DEBUG 76975 --- [nio-8080-exec-1] o.s.s.w.access.AccessDeniedHandlerImpl   : Responding with 403 status code\n"})}),(0,n.jsx)(r.h4,{id:"an\xe1lisis-del-ejemplo-de-log",children:"An\xe1lisis del Ejemplo de Log"}),(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Inicio del Proceso de Seguridad"}),": El primer mensaje de log dice que Spring Security est\xe1 protegiendo la solicitud ",(0,n.jsx)(r.code,{children:"POST /hello"}),". Esto significa que la solicitud est\xe1 siendo procesada por la ",(0,n.jsx)(r.strong,{children:"Cadena de Filtros"})," (Filter Chain) de seguridad."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Invocaci\xf3n de Filtros"}),": Los siguientes mensajes muestran c\xf3mo se invocan varios filtros uno por uno. Cada uno de estos filtros tiene una funci\xf3n espec\xedfica (como gestionar las cabeceras de seguridad o manejar sesiones). El filtro m\xe1s relevante aqu\xed es el ",(0,n.jsx)(r.strong,{children:"CsrfFilter"}),", que es el responsable de validar el token CSRF."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Rechazo por Token Inv\xe1lido"}),": Luego, el log muestra que el filtro de CSRF encontr\xf3 un token inv\xe1lido o ausente, lo que es la causa del rechazo de la solicitud. La respuesta fue un ",(0,n.jsx)(r.strong,{children:"error 403"}),", lo que indica que el usuario no tiene permiso para realizar esta operaci\xf3n debido a la falta del token CSRF."]}),"\n"]}),"\n"]})]}),"\n",(0,n.jsxs)(i,{children:[(0,n.jsx)(r.h3,{id:"c\xf3mo-configurar-logging-en-spring-security",children:"C\xf3mo Configurar Logging en Spring Security"}),(0,n.jsx)(r.p,{children:"Para habilitar el registro detallado de Spring Security en tu aplicaci\xf3n, puedes configurarlo de varias maneras. Aqu\xed te muestro dos de las m\xe1s comunes:"}),(0,n.jsxs)(i,{children:[(0,n.jsxs)(r.h4,{id:"opci\xf3n-1-usar-el-archivo-applicationproperties-en-spring-boot",children:["Opci\xf3n 1: Usar el archivo ",(0,n.jsx)(r.code,{children:"application.properties"})," en Spring Boot"]}),(0,n.jsxs)(r.p,{children:["Si est\xe1s usando ",(0,n.jsx)(r.strong,{children:"Spring Boot"}),", puedes agregar esta l\xednea a tu archivo ",(0,n.jsx)(r.code,{children:"application.properties"})," para habilitar el nivel TRACE en los registros de seguridad:"]}),(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-properties",children:"logging.level.org.springframework.security=TRACE\n"})}),(0,n.jsx)(r.p,{children:"Esto asegura que todos los eventos de seguridad se registren con el m\xe1ximo detalle disponible."})]}),(0,n.jsxs)(i,{children:[(0,n.jsxs)(r.h4,{id:"opci\xf3n-2-configuraci\xf3n-usando-logbackxml",children:["Opci\xf3n 2: Configuraci\xf3n usando ",(0,n.jsx)(r.code,{children:"logback.xml"})]}),(0,n.jsxs)(r.p,{children:["Si prefieres configurar tu sistema de logs usando ",(0,n.jsx)(r.strong,{children:"Logback"}),", puedes hacerlo de la siguiente manera en el archivo ",(0,n.jsx)(r.code,{children:"logback.xml"}),":"]}),(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-xml",children:'<configuration>\r\n    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">\r\n        \x3c!-- Configuraci\xf3n del appender para la consola --\x3e\r\n    </appender>\r\n    \x3c!-- Logger para Spring Security --\x3e\r\n    <logger name="org.springframework.security" level="trace" additivity="false">\r\n        <appender-ref ref="STDOUT" />\r\n    </logger>\r\n</configuration>\n'})}),(0,n.jsx)(r.p,{children:"Este bloque de configuraci\xf3n asegura que los eventos de seguridad se registren en la consola a nivel TRACE, mostrando todos los detalles que necesitas para depurar."})]})]}),"\n",(0,n.jsxs)(r.p,{children:["El logging en Spring Security es una herramienta muy poderosa para comprender y depurar las solicitudes rechazadas o los problemas de seguridad en tu aplicaci\xf3n. A trav\xe9s de los niveles ",(0,n.jsx)(r.strong,{children:"DEBUG"})," y ",(0,n.jsx)(r.strong,{children:"TRACE"}),", puedes obtener una visi\xf3n clara de c\xf3mo se manejan las solicitudes y por qu\xe9 se rechazan. Al habilitar el registro adecuado, podr\xe1s solucionar problemas de seguridad con mucha m\xe1s rapidez y precisi\xf3n, lo que mejorar\xe1 tanto la seguridad como la experiencia de desarrollo en general."]})]})}function u(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,r,i)=>{i.d(r,{R:()=>a,x:()=>l});var n=i(6540);const o={},s=n.createContext(o);function a(e){const r=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);